<?php

use Illuminate\Support\Facades\Schema;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Database\Migrations\Migration;

class CreateFormValueRangeTextView extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        DB::statement($this->dropView());
        DB::statement($this->createView());
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        DB::statement($this->dropView());
    }

    private function createView()
    {
        return <<<SQL
            CREATE VIEW `FormValueRangeText` AS select `FormValueRange`.`FormName` AS `FormName`,`FormValueRange`.`Name` AS `Name`,if((`FormValueRange`.`max1` IS NULL or (`FormValueRange`.`max1` = '')),if((`FormValueRange`.`min1` IS NULL or (`FormValueRange`.`min1` = '')),'',concat('min ',cast(`FormValueRange`.`min1` as char charset utf8))),if((`FormValueRange`.`min1` IS NULL or (`FormValueRange`.`min1` = '')),concat('max ',cast(`FormValueRange`.`max1` as char charset utf8)),concat(cast(`FormValueRange`.`min1` as char charset utf8),' to ',cast(`FormValueRange`.`max1` as char charset utf8)))) AS `range1`,if((`FormValueRange`.`max2` IS NULL or (`FormValueRange`.`max2` = '')),if((`FormValueRange`.`min2` IS NULL or (`FormValueRange`.`min2` = '')),'',concat('min ',cast(`FormValueRange`.`min2` as char charset utf8))),if((`FormValueRange`.`min2` IS NULL or (`FormValueRange`.`min2` = '')),concat('max ',cast(`FormValueRange`.`max2` as char charset utf8)),concat(cast(`FormValueRange`.`min2` as char charset utf8),' to ',cast(`FormValueRange`.`max2` as char charset utf8)))) AS `range2`,if((`FormValueRange`.`max3` IS NULL or (`FormValueRange`.`max3` = '')),if((`FormValueRange`.`min3` IS NULL or (`FormValueRange`.`min3` = '')),'',concat('min ',cast(`FormValueRange`.`min3` as char charset utf8))),if((`FormValueRange`.`min3` IS NULL or (`FormValueRange`.`min3` = '')),concat('max ',cast(`FormValueRange`.`max3` as char charset utf8)),concat(cast(`FormValueRange`.`min3` as char charset utf8),' to ',cast(`FormValueRange`.`max3` as char charset utf8)))) AS `range3`,if((`FormValueRange`.`max4` IS NULL or (`FormValueRange`.`max4` = '')),if((`FormValueRange`.`min4` IS NULL or (`FormValueRange`.`min4` = '')),'',concat('min ',cast(`FormValueRange`.`min4` as char charset utf8))),if((`FormValueRange`.`min4` IS NULL or (`FormValueRange`.`min4` = '')),concat('max ',cast(`FormValueRange`.`max4` as char charset utf8)),concat(cast(`FormValueRange`.`min4` as char charset utf8),' to ',cast(`FormValueRange`.`max4` as char charset utf8)))) AS `range4`,if((`FormValueRange`.`max5` IS NULL or (`FormValueRange`.`max5` = '')),if((`FormValueRange`.`min5` IS NULL or (`FormValueRange`.`min5` = '')),'',concat('min ',cast(`FormValueRange`.`min5` as char charset utf8))),if((`FormValueRange`.`min5` IS NULL or (`FormValueRange`.`min5` = '')),concat('max ',cast(`FormValueRange`.`max5` as char charset utf8)),concat(cast(`FormValueRange`.`min5` as char charset utf8),' to ',cast(`FormValueRange`.`max5` as char charset utf8)))) AS `range5`,if((`FormValueRange`.`max6` IS NULL or (`FormValueRange`.`max6` = '')),if((`FormValueRange`.`min6` IS NULL or (`FormValueRange`.`min6` = '')),'',concat('min ',cast(`FormValueRange`.`min6` as char charset utf8))),if((`FormValueRange`.`min6` IS NULL or (`FormValueRange`.`min6` = '')),concat('max ',cast(`FormValueRange`.`max6` as char charset utf8)),concat(cast(`FormValueRange`.`min6` as char charset utf8),' to ',cast(`FormValueRange`.`max6` as char charset utf8)))) AS `range6`,if((`FormValueRange`.`max7` IS NULL or (`FormValueRange`.`max7` = '')),if((`FormValueRange`.`min7` IS NULL or (`FormValueRange`.`min7` = '')),'',concat('min ',cast(`FormValueRange`.`min7` as char charset utf8))),if((`FormValueRange`.`min7` IS NULL or (`FormValueRange`.`min7` = '')),concat('max ',cast(`FormValueRange`.`max7` as char charset utf8)),concat(cast(`FormValueRange`.`min7` as char charset utf8),' to ',cast(`FormValueRange`.`max7` as char charset utf8)))) AS `range7`,if((`FormValueRange`.`max8` IS NULL or (`FormValueRange`.`max8` = '')),if((`FormValueRange`.`min8` IS NULL or (`FormValueRange`.`min8` = '')),'',concat('min ',cast(`FormValueRange`.`min8` as char charset utf8))),if((`FormValueRange`.`min8` IS NULL or (`FormValueRange`.`min8` = '')),concat('max ',cast(`FormValueRange`.`max8` as char charset utf8)),concat(cast(`FormValueRange`.`min8` as char charset utf8),' to ',cast(`FormValueRange`.`max8` as char charset utf8)))) AS `range8`,if((`FormValueRange`.`max9` IS NULL or (`FormValueRange`.`max9` = '')),if((`FormValueRange`.`min9` IS NULL or (`FormValueRange`.`min9` = '')),'',concat('min ',cast(`FormValueRange`.`min9` as char charset utf8))),if((`FormValueRange`.`min9` IS NULL or (`FormValueRange`.`min9` = '')),concat('max ',cast(`FormValueRange`.`max9` as char charset utf8)),concat(cast(`FormValueRange`.`min9` as char charset utf8),' to ',cast(`FormValueRange`.`max9` as char charset utf8)))) AS `range9`,if((`FormValueRange`.`max10` IS NULL or (`FormValueRange`.`max10` = '')),if((`FormValueRange`.`min10` IS NULL or (`FormValueRange`.`min10` = '')),'',concat('min ',cast(`FormValueRange`.`min10` as char charset utf8))),if((`FormValueRange`.`min10` IS NULL or (`FormValueRange`.`min10` = '')),concat('max ',cast(`FormValueRange`.`max10` as char charset utf8)),concat(cast(`FormValueRange`.`min10` as char charset utf8),' to ',cast(`FormValueRange`.`max10` as char charset utf8)))) AS `range10`,if((`FormValueRange`.`max1` IS NULL or (`FormValueRange`.`max11` = '')),if((`FormValueRange`.`min11` IS NULL or (`FormValueRange`.`min11` = '')),'',concat('min ',cast(`FormValueRange`.`min11` as char charset utf8))),if((`FormValueRange`.`min11` IS NULL or (`FormValueRange`.`min11` = '')),concat('max ',cast(`FormValueRange`.`max11` as char charset utf8)),concat(cast(`FormValueRange`.`min11` as char charset utf8),' to ',cast(`FormValueRange`.`max11` as char charset utf8)))) AS `range11`,if((`FormValueRange`.`max12` IS NULL or (`FormValueRange`.`max12` = '')),if((`FormValueRange`.`min12` IS NULL or (`FormValueRange`.`min12` = '')),'',concat('min ',cast(`FormValueRange`.`min12` as char charset utf8))),if((`FormValueRange`.`min12` IS NULL or (`FormValueRange`.`min12` = '')),concat('max ',cast(`FormValueRange`.`max12` as char charset utf8)),concat(cast(`FormValueRange`.`min12` as char charset utf8),' to ',cast(`FormValueRange`.`max12` as char charset utf8)))) AS `range12`,if((`FormValueRange`.`max13` IS NULL or (`FormValueRange`.`max13` = '')),if((`FormValueRange`.`min13` IS NULL or (`FormValueRange`.`min13` = '')),'',concat('min ',cast(`FormValueRange`.`min13` as char charset utf8))),if((`FormValueRange`.`min13` IS NULL or (`FormValueRange`.`min13` = '')),concat('max ',cast(`FormValueRange`.`max13` as char charset utf8)),concat(cast(`FormValueRange`.`min13` as char charset utf8),' to ',cast(`FormValueRange`.`max13` as char charset utf8)))) AS `range13`,if((`FormValueRange`.`max14` IS NULL or (`FormValueRange`.`max14` = '')),if((`FormValueRange`.`min14` IS NULL or (`FormValueRange`.`min14` = '')),'',concat('min ',cast(`FormValueRange`.`min14` as char charset utf8))),if((`FormValueRange`.`min14` IS NULL or (`FormValueRange`.`min14` = '')),concat('max ',cast(`FormValueRange`.`max14` as char charset utf8)),concat(cast(`FormValueRange`.`min14` as char charset utf8),' to ',cast(`FormValueRange`.`max14` as char charset utf8)))) AS `range14`,if((`FormValueRange`.`max15` IS NULL or (`FormValueRange`.`max15` = '')),if((`FormValueRange`.`min15` IS NULL or (`FormValueRange`.`min15` = '')),'',concat('min ',cast(`FormValueRange`.`min15` as char charset utf8))),if((`FormValueRange`.`min15` IS NULL or (`FormValueRange`.`min15` = '')),concat('max ',cast(`FormValueRange`.`max15` as char charset utf8)),concat(cast(`FormValueRange`.`min15` as char charset utf8),' to ',cast(`FormValueRange`.`max15` as char charset utf8)))) AS `range15`,if((`FormValueRange`.`max16` IS NULL or (`FormValueRange`.`max16` = '')),if((`FormValueRange`.`min16` IS NULL or (`FormValueRange`.`min16` = '')),'',concat('min ',cast(`FormValueRange`.`min16` as char charset utf8))),if((`FormValueRange`.`min16` IS NULL or (`FormValueRange`.`min16` = '')),concat('max ',cast(`FormValueRange`.`max16` as char charset utf8)),concat(cast(`FormValueRange`.`min16` as char charset utf8),' to ',cast(`FormValueRange`.`max16` as char charset utf8)))) AS `range16`,if((`FormValueRange`.`max17` IS NULL or (`FormValueRange`.`max17` = '')),if((`FormValueRange`.`min17` IS NULL or (`FormValueRange`.`min17` = '')),'',concat('min ',cast(`FormValueRange`.`min17` as char charset utf8))),if((`FormValueRange`.`min17` IS NULL or (`FormValueRange`.`min17` = '')),concat('max ',cast(`FormValueRange`.`max17` as char charset utf8)),concat(cast(`FormValueRange`.`min17` as char charset utf8),' to ',cast(`FormValueRange`.`max17` as char charset utf8)))) AS `range17`,if((`FormValueRange`.`max18` IS NULL or (`FormValueRange`.`max18` = '')),if((`FormValueRange`.`min18` IS NULL or (`FormValueRange`.`min18` = '')),'',concat('min ',cast(`FormValueRange`.`min18` as char charset utf8))),if((`FormValueRange`.`min18` IS NULL or (`FormValueRange`.`min18` = '')),concat('max ',cast(`FormValueRange`.`max18` as char charset utf8)),concat(cast(`FormValueRange`.`min18` as char charset utf8),' to ',cast(`FormValueRange`.`max18` as char charset utf8)))) AS `range18`,if((`FormValueRange`.`max19` IS NULL or (`FormValueRange`.`max19` = '')),if((`FormValueRange`.`min19` IS NULL or (`FormValueRange`.`min19` = '')),'',concat('min ',cast(`FormValueRange`.`min19` as char charset utf8))),if((`FormValueRange`.`min19` IS NULL or (`FormValueRange`.`min19` = '')),concat('max ',cast(`FormValueRange`.`max19` as char charset utf8)),concat(cast(`FormValueRange`.`min19` as char charset utf8),' to ',cast(`FormValueRange`.`max19` as char charset utf8)))) AS `range19`,if((`FormValueRange`.`max20` IS NULL or (`FormValueRange`.`max20` = '')),if((`FormValueRange`.`min20` IS NULL or (`FormValueRange`.`min20` = '')),'',concat('min ',cast(`FormValueRange`.`min20` as char charset utf8))),if((`FormValueRange`.`min20` IS NULL or (`FormValueRange`.`min20` = '')),concat('max ',cast(`FormValueRange`.`max20` as char charset utf8)),concat(cast(`FormValueRange`.`min20` as char charset utf8),' to ',cast(`FormValueRange`.`max20` as char charset utf8)))) AS `range20` from `FormValueRange` order by `FormValueRange`.`FormName`
        SQL;
    }

    private function dropView()
    {
        return <<<SQL
            DROP VIEW IF EXISTS `FormValueRangeText`;
        SQL;
    }
}
